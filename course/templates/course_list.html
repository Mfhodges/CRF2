{% extends "base_generic.html" %}

<!-- this sets the nav li to active -->
{% block courses %}active{% endblock %}
<!-- see for date format info https://docs.djangoproject.com/en/2.1/ref/settings/#date-input-formats -->

{% block content %}
<div class="medium-container">

  <!-- add filtering bit -->

<h1>Courses</h1>

<p> Results({{ data.count }}) </p>
<!--<p> previous{{ data.previous }} </p>
<p> next{{ data.next}} </p> -->



<p>&ltFiltering goes here&gt</p>

  <table class="striped-table">
    <thead>
      <tr>
        <th>Section</th>
        <th>Title</th>
        <th>Activity</th>
        <th>Instructor</th>
        <th>Created Date</th>
        <th>Request Status</th>
      </tr>
    </thead>
    <tbody>
      {% for course in data %}
      <tr>

        <td><a href='{% url "UI-course-detail" pk=course.course_SRS_Title %}'>{{course.course_SRS_Title}} </a></td>
        <td>{{course.course_name}}</td>
        <td>{{course.course_activity}}</td>

        <td>
          {% for instructor in course.instructors %}
              {% if forloop.last %}
                {{instructor}}
              {% else %}
                {{instructor}},
              {% endif %}
          {% endfor %}
        </td>
        <td>{{course.created}} </td>
        <!--<td>{{course.created|date:'m/d/Y'}} {{course.created|time:'h:i' }}</td> -->
        <td>
          <!-- REQUEST MODAL -->
          {{course.requested}}
          {% if course.requested == True %}
              <!-- this button should pull up the submitted request! -->
              <a  href='{% url "UI-request-detail" pk=course.course_SRS_Title %}' class="button muted-button" data-toggle="tooltip" data-placement="top" title="click to see details">Requested</a>
          {% else %}
            <!--  <input type="hidden" name="requested" value="true">
              <button type="submit" class="button" >Request</button>-->

              <!-- Button trigger modal -->
              <button class="button" data-toggle="modal" data-target="#exampleModalCenter" >
                Request
              </button>

              <!-- Modal -->
              <!-- simplify with this https://getbootstrap.com/docs/4.0/components/modal/#varying-modal-content -->

              <div class="modal fade" id="exampleModalCenter" tabindex="-1" role="dialog" aria-labelledby="exampleModalCenterTitle" aria-hidden="true">
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLongTitle">Basic Request</h5>
                      <div class="close" data-dismiss="modal" aria-label="Close">
                        <i class="fas fa-times"></i>
                      </div>
                    </div>
                    <form action="{% url 'request-list' %}" method="POST">
                      {% csrf_token %}
                        <div class="modal-body">
                          <label for="inputCanvasID">Copy From Canvas Site </label>
                          <input type="text" id="inputCanvasID" name="copy_from_course" class="form-control mx-sm-3" placeholder="CANVAS SITE ID" aria-describedby="textHelpInline">
                          <small id="passwordHelpInline" class="text-muted">
                            Canvas Site ID is found in `https://canvas.upenn.edu/courses/&lt;CANVAS_ID&gt;`
                            If left blank, the course created will have no content copied.
                          </small>
                        </div>
                        <div class="modal-footer">
                          <small> Hide these values later </small>
                          <input name="course_requested" class="form-control" type="text" value="1">
                          <input name="status" class="form-control" type="hidden" value="SUBMITTED">
                          <input name="view_type" class="form-control" type="hidden" value="UI">
                          <button type="button" class="accent-button" style="font-weight: 600;">Custom Request</button> <!-- Custom Request takes you to the full page form -->
                          <button type="submit" value="save" style="font-weight: 600;">Submit request</button>
                        </div>
                    </form>
                  </div>
                </div>
              </div>

          {% endif %}


        </td>
      </tr>
        {% endfor %}
    </tbody>
  </table>


<!-- PAGINATION -->
<nav aria-label="Page navigation example" style="padding-top:0px;">
  <ul class="pagination justify-content-center">

      {% if pagination.prev.value %}
    <li class="page-item">
      <a class="page-link" href="{{ pagination.prev.url }}" tabindex="-1">Previous</a>
      {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="" tabindex="-1">Previous</a>
      {% endif %}
    </li>

<!-- fix these links-->
<!-- could be taking advantage of a foorlop somewhere -->

    {% if pagination.prev %}
      <li class="page-item"><a class="page-link" href="{{pagination.prev.url}}">{{pagination.prev.value}}</a></li>
    {% endif %}

    <li class="page-item active"><a class="page-link" href="{{pagination.current.url}}">{{pagination.current.value}}</a></li>
    {% if pagination.next %}
      {% if pagination.next.value != pagination.last.value %}
        <li class="page-item"><a class="page-link" href="{{pagination.next.url}}">{{pagination.next.value}}</a></li>
          <li class="page-item"><a class="page-link" href="?page={{pagination.next.value|add:"1"}}">{{pagination.next.value|add:"1"}}</a></li>

          <!--<li class="page-item disabled"><a class="page-link" href="">...</a></li>-->

      {% endif %}
      <li class="page-item"><a class="page-link" href='{{ pagination.last.url }}'>{{pagination.last.value}}</a></li>
    {% endif %}



  <!--  {% if pagination.last.url %}
    <li class="page-item"><a class="page-link" href='{{ pagination.last.url }}'>{{pagination.last.value}}</a></li>
    {% endif %} -->

    {% if pagination.next.url %}
    <li class="page-item">
      <a class="page-link" href={{pagination.next.url}}>Next</a>

    {% else %}
    <li class="page-item disabled">
      <a class="page-link" href="" tabindex="-1">Next</a>

    {% endif %}
  </li>
  </ul>
</nav>


{% if is_paginated %}
  <ul class="pagination">
    {% if page_obj.has_previous %}
      <li><a href="?page={{ page_obj.previous_page_number }}">&laquo;</a></li>
    {% else %}
      <li class="disabled"><span>&laquo;</span></li>
    {% endif %}
    {% for i in paginator.page_range %}
      {% if page_obj.number == i %}
        <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
      {% else %}
        <li><a href="?page={{ i }}">{{ i }}</a></li>
      {% endif %}
    {% endfor %}
    {% if page_obj.has_next %}
      <li><a href="?page={{ page_obj.next_page_number }}">&raquo;</a></li>
    {% else %}
      <li class="disabled"><span>&raquo;</span></li>
    {% endif %}
  </ul>
{% endif %}


</div>
{% endblock %}
